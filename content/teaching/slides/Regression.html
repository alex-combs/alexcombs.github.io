<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>PADP 7120 Data Applications in PA</title>
    <meta charset="utf-8" />
    <meta name="author" content="Alex Combs" />
    <script src="Regression_files/header-attrs-2.14/header-attrs.js"></script>
    <link rel="stylesheet" href="mypres.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

.title[
# PADP 7120 Data Applications in PA
]
.subtitle[
## Simple &amp; Multiple Linear Regression
]
.author[
### Alex Combs
]
.institute[
### UGA | SPIA | PADP
]
.date[
### Last updated: October 03, 2022
]

---

# Outline



- Understand the purpose of regression and its relevance to making decisions

- Interpret regression coefficients

- Assess goodness-of-fit for one model or between several competing models

- Understand what it means to control for other variables

---
# Correlation coefficients


```r
select(States, -region) %&gt;% 
  cor()
```

```
##                pop       SATV       SATM    percent    dollars        pay
## pop      1.0000000 -0.3381028 -0.2300418  0.2100687  0.1436745  0.3677244
## SATV    -0.3381028  1.0000000  0.9620359 -0.8627954 -0.5268313 -0.5559238
## SATM    -0.2300418  0.9620359  1.0000000 -0.8581495 -0.4844477 -0.4853306
## percent  0.2100687 -0.8627954 -0.8581495  1.0000000  0.7111474  0.6630098
## dollars  0.1436745 -0.5268313 -0.4844477  0.7111474  1.0000000  0.8476737
## pay      0.3677244 -0.5559238 -0.4853306  0.6630098  0.8476737  1.0000000
```

---
# Visualizing correlation


```r
ggplot(States, aes(x = dollars, y = SATM)) +
  geom_point() +
  labs(x = 'Public ed spending in $1000s per student',
       y = 'Average SAT Math score') +
  theme(text=element_text(size=18))
```

&lt;img src="Regression_files/figure-html/unnamed-chunk-3-1.png" style="display: block; margin: auto;" /&gt;

---
# Correlation conclusions

&lt;img src="Regression_files/figure-html/unnamed-chunk-4-1.png" style="display: block; margin: auto;" /&gt;

- States that spend more on public education tend to have lower average SAT Math scores among its graduating high school students

- The strength of the relationship is moderate at -0.48

---
# Basic purpose of regression

.pull-left[
![](Regression_files/figure-html/unnamed-chunk-5-1.png)&lt;!-- --&gt;
]

.pull-right[
- Regression gives us direction, strength, and magnitude of association
- Draws the line of **best fit** through a set of paired x-y data points
- The slope of the line tells us the **average, predicted change in y given a change in x**, or
- At any value along x-axis, regression line gives us the **predicted value of y**
]

---
# Basic purpose of regression

- Regression is a way of modeling an outcome `\(y\)` as a function of one or more explanatory variables `\(x\)`.

- Regression can be used to **explain** an outcome or **predict** an outcome, or both.

---
# Adding a regression line


```r
ggplot(States, aes(x = dollars, y = SATM)) +
  geom_point() +
* geom_smooth(method = 'lm', se = FALSE) +
  labs(x = 'Public ed spending in $1000s per student',
       y = 'Average SAT Math score')
```

&lt;img src="Regression_files/figure-html/unnamed-chunk-6-1.png" style="display: block; margin: auto;" /&gt;

---
# Equation of a line

`$$y = 600 - 20x$$`

- If `\(x=5\)`, `\(y=?\)`

- If `\(x=6\)`, `\(y=?\)`

--

- If `\(x\)` increases from 5 to 6, by how much does `\(y\)` change?

- If `\(x\)` increases from 2 to 5, by how much does `\(y\)` change?

---
# Simple linear regression model

`$$y=\beta_0+\beta_1x+\epsilon$$`

- Which represents the dependent variable?
- Which represents the independent variable?
- Which represents the unknown population parameters?
- Which represents statistical noise?

---
# Simple linear regression model

`$$\hat{y}=b_0+b_1x$$`

- Which represents the predicted outcome?
- Which represents the estimates?

---
# Example: Population to sample models

- Suppose we want to model average SAT math scores, `SATM`, in a state as a function of its spending on public education in **$1000s per student**, `dollars`

`$$SATM=\beta_0+\beta_1Dollars+\epsilon$$`

--

&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt; term &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; estimate &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; std_error &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; statistic &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; p_value &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; lower_ci &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; upper_ci &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; intercept &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 560.374 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 16.801 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 33.353 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 526.610 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 594.137 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; dollars &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -12.169 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3.139 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -3.876 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -18.478 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -5.860 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

--

`$$\hat{SATM} = 560 - 12.17 \times Dollars$$`

---
# Example: Reporting results

`$$\hat{SATM} = 560 - 12.17 \times Dollars$$`

On average, a one thousand dollar increase in state spending on public education per student is associated with a 12 point decline in average SAT math scores.

--

- What is the predicted increase in `SATM` if a state increased `Dollars` by $2,500 per student?

--

- What is the predicted `SATM` in a state that spends $5,000 per student?

--

- What is the predicted `SATM` in a state that spends $0 per student?

---
# Another example

- Now `SATM` as a function of the percent of graduating high school students who take the SAT, `percent`

`$$SATM=\beta_0+\beta_1Percent+\epsilon$$`
&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt; term &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; estimate &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; std_error &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; statistic &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; p_value &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; lower_ci &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; upper_ci &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; intercept &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 538.975 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4.351 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 123.870 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 530.231 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 547.719 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; percent &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -1.232 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.105 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -11.701 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -1.444 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -1.021 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

`$$\hat{SATM} = 539 - 1.23 \times Percent$$`

- Now we can consider any hypothetical *change* in percent or specific *value* of percent and provide a prediction for SAT math scores.

---
# Change vs. value
`$$\hat{SATM} = 539 - 1.23 \times Percent$$`
.pull-left[
**Predicted Change**

What if percent taking SAT increased from 50% to 55%?

]

--

.pull-right[

**Predicted Value**

What is the predicted average SAT math score for a state where 75% of high school graduates take the SAT?

]

---
# More practice

`$$\hat{SATM} = 539 - 1.23 \times Percent$$`

- What is the predicted average SAT math score in a state where 25% of its high school graduates take the SAT?
- What is the predicted average SAT math score in a state where 100% of its high school graduates take the SAT?
- What is the predicted change in average SAT math score in a state where the percent of high school graduates taking the SAT increases 75 percentage points?

---
class: inverse, middle, center

# Make sure you understand the difference between a percent change and a percentage point change.

---
class: inverse, middle, center

# Running regressions in R

---
# Running regression

- Explore data


```r
glimpse(States)
```

```
## Rows: 51
## Columns: 7
## $ region  &lt;fct&gt; ESC, PAC, MTN, WSC, PAC, MTN, NE, SA, SA, SA, SA, PAC, MTN, EN…
## $ pop     &lt;int&gt; 4041, 550, 3665, 2351, 29760, 3294, 3287, 666, 607, 12938, 647…
## $ SATV    &lt;int&gt; 470, 438, 445, 470, 419, 456, 430, 433, 409, 418, 401, 404, 46…
## $ SATM    &lt;int&gt; 514, 476, 497, 511, 484, 513, 471, 470, 441, 466, 443, 481, 50…
## $ percent &lt;int&gt; 8, 42, 25, 6, 45, 28, 74, 58, 68, 44, 57, 52, 17, 16, 54, 5, 1…
## $ dollars &lt;dbl&gt; 3.648, 7.887, 4.231, 3.334, 4.826, 4.809, 7.914, 6.016, 8.210,…
## $ pay     &lt;int&gt; 27, 43, 30, 23, 39, 31, 43, 35, 39, 30, 29, 32, 25, 34, 32, 28…
```

---
# Running regression


```r
summary(States)
```


```
##       pop             SATV            SATM          percent     
##  Min.   :  454   Min.   :397.0   Min.   :437.0   Min.   : 4.00  
##  1st Qu.: 1215   1st Qu.:422.5   1st Qu.:470.0   1st Qu.:11.50  
##  Median : 3294   Median :443.0   Median :490.0   Median :25.00  
##  Mean   : 4877   Mean   :448.2   Mean   :497.4   Mean   :33.75  
##  3rd Qu.: 5780   3rd Qu.:474.5   3rd Qu.:522.5   3rd Qu.:57.50  
##  Max.   :29760   Max.   :511.0   Max.   :577.0   Max.   :74.00  
##     dollars           pay       
##  Min.   :2.993   Min.   :22.00  
##  1st Qu.:4.354   1st Qu.:27.50  
##  Median :5.045   Median :30.00  
##  Mean   :5.175   Mean   :30.94  
##  3rd Qu.:5.689   3rd Qu.:33.50  
##  Max.   :9.159   Max.   :43.00
```


---
# Running regression


```r
satm_mod1 &lt;- lm(SATM ~ dollars, data = States)
satm_mod2 &lt;- lm(SATM ~ percent, data = States)
```


```r
library(moderndive)
get_regression_table(satm_mod1)
```

|term      | estimate| std_error| statistic| p_value| lower_ci| upper_ci|
|:---------|--------:|---------:|---------:|-------:|--------:|--------:|
|intercept |  560.374|    16.801|    33.353|       0|  526.610|  594.137|
|dollars   |  -12.169|     3.139|    -3.876|       0|  -18.478|   -5.860|

---
class: inverse, center, middle

# Regression Residual

---
# Recap of population and sample regressions

**Population Model**

`$$y=\beta_0+\beta_1x+\epsilon$$`

`$$SATM=\beta_0+\beta_1Dollars+\epsilon$$`

**Sample Model**

`$$\hat{y}=b_0+b_1x$$`
`$$\hat{SATM} = 560 - 12.17 \times Dollars$$`

- What happens to the error term, `\(\epsilon\)`, when we move to the sample model?

---
# The residual

`$$e=y-\hat{y}$$`

- The residual is the difference between the *observed* outcome `\(y\)` and the *predicted* outcome `\(\hat{y}\)` in our regression model

- The residual is the sample statistic of the population parameter `\(\epsilon\)`




&lt;img src="Regression_files/figure-html/unnamed-chunk-16-1.png" style="display: block; margin: auto;" /&gt;

---
# Residuals

`$$\hat{SATM} = 560 - 12.17 \times Dollars$$`

- What is the predicted `SATM` for a state where `dollars` equals $7,887? 

- How about a state where `dollars` equals $4,231?

--

- If there are `SATM` scores we can observe for states with these specific values for `dollars`, then we can check by how much our regression model overestimates or underestimates `SATM`.

---
# Examining residuals


```r
get_regression_points(satm_mod1)
```

- Regression results for each observation

- Shows observed data, predicted outcomes, and residuals

&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:right;"&gt; ID &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; SATM &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; dollars &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; SATM_hat &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; residual &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 514 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3.648 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 515.980 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -1.980 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 2 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 476 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 7.887 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 464.395 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 11.605 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 3 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 497 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4.231 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 508.886 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -11.886 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 4 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 511 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3.334 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 519.802 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -8.802 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 5 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 484 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4.826 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 501.645 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -17.645 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 6 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 513 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4.809 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 501.852 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 11.148 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

---
class: inverse, center, middle

# Goodness-of-fit

---
# Ordinary least squares (OLS)

- Regression draws the **line of best fit** through observed data. What does best fit mean?

- Simple linear regression is also known as ordinary least squares (OLS)

- Regression uses calculus and matrix algebra to determine the intercept and slope of a line that minimizes the sum of squared residuals (SSR)

---
# OLS

.pull-left[
![](Regression_files/figure-html/unnamed-chunk-19-1.png)&lt;!-- --&gt;
]

.pull-right[
&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:right;"&gt; ID &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; SATM &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; SATM_hat &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; residual &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 514 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 515.980 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -1.980 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 2 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 476 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 464.395 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 11.605 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 3 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 497 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 508.886 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -11.886 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 4 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 511 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 519.802 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -8.802 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 5 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 484 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 501.645 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -17.645 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 6 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 513 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 501.852 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 11.148 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 7 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 471 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 464.067 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 6.933 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 8 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 470 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 487.164 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -17.164 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
]

---
# OLS

&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:right;"&gt; ID &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; SATM &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; dollars &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; SATM_hat &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; residual &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; sq_resid &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 514 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3.648 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 515.980 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -1.980 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3.9204 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 2 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 476 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 7.887 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 464.395 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 11.605 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 134.6760 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 3 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 497 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4.231 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 508.886 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -11.886 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 141.2770 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 4 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 511 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3.334 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 519.802 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -8.802 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 77.4752 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;


```r
sum(satm_mod1_points$sq_resid)
```

```
## [1] 45727.36
```

- No other line will achieve a sum of squared residuals less than 45,727

- But this tells us nothing of *how good* this best fit is

---
# Goodness-of-fit

- When we ask how good is our best regression line, one way to answer is the **percent of total variation/variance in the outcome that is explained by our model**

--

- `\(R^2\)` (r-squared)
  - Ranges from 0 to 1
  - The percent of variation in `\(y\)` explained by our regression model

---
# Goodness of fit

- Model 1 using `dollars`


```r
get_regression_summaries(satm_mod1)
```

&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:right;"&gt; r_squared &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; adj_r_squared &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; rmse &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; sigma &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 0.235 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.219 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 29.94355 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 30.549 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

The regression using dollars explains 24% of total variation in average SAT math scores.

---
# Goodness of fit

- Model 2 using `percent`


```r
get_regression_summaries(satm_mod2)
```

&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:right;"&gt; r_squared &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; adj_r_squared &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; rmse &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; sigma &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 0.736 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.731 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 17.57277 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 17.928 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

- What percent of variation in average SAT math scores is explained by model 2?

--

- Model 2 has the higher `\(R^2\)`. It is *statistically* superior.

---
# Goodness of fit

.pull-left[
&lt;img src="Regression_files/figure-html/unnamed-chunk-27-1.png" style="display: block; margin: auto;" /&gt;
]

.pull-right[
&lt;img src="Regression_files/figure-html/unnamed-chunk-28-1.png" style="display: block; margin: auto;" /&gt;
]

- Note that the data points in model 2 (right) are closer to the regression line -&gt; less unexplained variance in `SATM` -&gt; higher `\(R^2\)`

---
# Goodness of fit

- `\(R^2\)` may not be useful for a general audience and it has limited practical application for predictions.

--

- Root mean squared error (**RMSE**) answers the question: "How far off is our model, on average, from observed outcomes? If we predict an outcome, what is the typical range of inaccuracy?

--

- RMSE is the regression version of standard deviation; provides the average deviation from the regression line

- The lower the RMSE the better our model is at fitting the data

---
# Goodness of fit
Model 1 using dollars
&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:right;"&gt; r_squared &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; adj_r_squared &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; rmse &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; sigma &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 0.235 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.219 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 29.94355 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 30.549 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

Model 2 using percent
&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:right;"&gt; r_squared &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; adj_r_squared &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; rmse &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; sigma &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 0.736 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.731 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 17.57277 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 17.928 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

--

.pull-left[
- Model 1 predictions are off by about 30 points, on average.
- What about model 2?
]

--

.pull-right[
- Model 2 predictions are off by about 18 points, on average.
- Model 2 is the *statistically* superior model.
]

---
class: inverse, center, middle

# Multiple regression

---
# Multiple regression

- Multiple regression adds more than one explanatory variable to the model. 

--

**Population model**
`$$y=\beta_0+\beta_1x_1+\beta_2x_2+\dots+\beta_kx_k+\epsilon$$`

**Sample model**
`$$\hat{y}=b_0+b_1x_1+b_2x_2+\dots+b_kx_k$$`

--

- This isolates the association between the outcome and each explanatory variable, holding all other variables constant at their respective means.

---
# Controlling for other factors

- The two previous regressions each controlled for one variable we might theorize affects average state SAT math scores

--

- There is any number of additional variables contained in the error term `\(\epsilon\)`

--

- Typically, if we can, we should include those additional variables in the same regression model

- Especially if those variables affect the explanatory variables currently in our model

---
# Making sense of our results

- So far, we find states spending more on public education tend to have lower SAT math scores (perhaps counter-intuitive). We also find that states with a higher percent of graduates taking the SAT tend to have lower SAT math scores. What may be going on here?

.pull-left[
&lt;img src="Regression_files/figure-html/unnamed-chunk-31-1.png" style="display: block; margin: auto;" /&gt;
]

.pull-right[
&lt;img src="Regression_files/figure-html/unnamed-chunk-32-1.png" style="display: block; margin: auto;" /&gt;
]

---
# Making sense of our results

&lt;img src="Regression_files/figure-html/unnamed-chunk-33-1.png" style="display: block; margin: auto;" /&gt;

---
# Running multiple regression

`$$SATM=\beta_0+\beta_1Dollars+\beta_2Percent+\epsilon$$`


```r
satm_mod3 &lt;- lm(SATM ~ dollars + percent, data = States)
```

```r
get_regression_table(satm_mod3)
```
&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt; term &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; estimate &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; std_error &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; statistic &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; p_value &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; lower_ci &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; upper_ci &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; intercept &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 514.652 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 10.299 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 49.969 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.000 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 493.944 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 535.360 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; dollars &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 6.395 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2.482 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2.577 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.013 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1.405 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 11.384 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; percent &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -1.492 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.142 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -10.519 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.000 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -1.777 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -1.207 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

`$$SATM=515+6.4 \times Dollars - 1.5 \times Percent+\epsilon$$`

---
# Reporting results

`$$SATM=515+6.4 \times Dollars - 1.5 \times Percent+\epsilon$$`

On average, a one thousand dollar increase in spending per pupil is associated with 6.4 point increase in average state SAT math scores, **controlling for the percent of students taking the SAT**.

---
# Interpreting results

&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt; term &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; estimate &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; std_error &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; statistic &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; p_value &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; lower_ci &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; upper_ci &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; intercept &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 514.652 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 10.299 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 49.969 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.000 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 493.944 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 535.360 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; dollars &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 6.395 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2.482 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2.577 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.013 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1.405 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 11.384 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; percent &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -1.492 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.142 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -10.519 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.000 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -1.777 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -1.207 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

`$$SATM=515+6.4 \times Dollars - 1.5 \times Percent+\epsilon$$`

- Controlling for the percent of graduates taking the SAT, what is the predicted change in SAT math scores if states increase public education spending by $5,000 per student?

---
# Interpreting results

&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt; term &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; estimate &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; std_error &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; statistic &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; p_value &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; lower_ci &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; upper_ci &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; intercept &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 514.652 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 10.299 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 49.969 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.000 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 493.944 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 535.360 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; dollars &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 6.395 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2.482 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2.577 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.013 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1.405 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 11.384 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; percent &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -1.492 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.142 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -10.519 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.000 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -1.777 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -1.207 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

`$$SATM=515+6.4 \times Dollars - 1.5 \times Percent+\epsilon$$`

What is the predicted average SAT math score for a state that spends $5,000 per student, and has 50% of high school graduates take the SAT?

---
class: inverse, middle, center

# Connecting results to policy decisions

---
# Policy Decision

- For now, let's ignore inference and assume these results are meaningful.

--

- Spending increases average SAT math scores among states, **controlling for percent of high school grads taking SAT**
  
- But spending seems to increase the percent of SAT participation, which then decreases average SAT math scores

- Let's quantify the effect of spending on SAT participation

---
# Spending and SAT participation


```r
satm_mod4 &lt;- lm(percent ~ dollars, data = States)
```


```r
get_regression_table(satm_mod4)
```

&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt; term &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; estimate &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; std_error &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; statistic &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; p_value &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; lower_ci &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; upper_ci &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; intercept &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -30.64 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 9.403 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -3.259 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.002 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -49.536 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -11.744 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; dollars &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 12.44 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1.757 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 7.081 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.000 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 8.910 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 15.971 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

- A $1,000 increase in spending per pupil increases the percent of grads taking the SAT by 12.4 *percentage points*.

---
# Policy Decision

- A $1,000 increase in spending per student:
  
  - Directly increases average SAT math scores 6.4 points
  
  - Directly increases participation 12.4 percentage points
  
  - Increase of 12.4 p.p. reduces average SAT math scores 18.6 points
  
- The total effect of a $1,000 increase on average SAT math scores is about -12.2 points. Same as first model.

--

- Do these results help inform a policy recommendation concerning education spending and scores on college entrance exams?

---
class: inverse, middle, center

# Goodness-of-fit with multiple regression

---
# Goodness-of-fit

**Model 2 using only percent**
&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:right;"&gt; r_squared &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; adj_r_squared &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; rmse &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; sigma &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 0.736 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.731 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 17.57277 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 17.928 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

**Model 3 using dollars and percent**

&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:right;"&gt; r_squared &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; adj_r_squared &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; mse &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; rmse &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; sigma &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 0.768 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.759 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 271.2768 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 16.47048 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 16.977 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

- Based on `\(R^2\)`, model 3 appears to be the better model, however...

---
# Goodness of fit

- `\(R^2\)` mechanically increases as you add more variables whether or not they improve the model

- Therefore, we should not use `\(R^2\)` to compare models with different numbers of explanatory variables

--

- **Adjusted `\(R^2\)` ** accounts for this, adjusting based on how useful each additional variable is at explaining the outcome

- Model 3 still has the higher adjusted `\(R^2\)` so it remains the statistically better model

- And the RMSE agrees; virtually always the case
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script src="macros.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"countIncrementalSlides": false,
"highlightLines": true
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
// add `data-at-shortcutkeys` attribute to <body> to resolve conflicts with JAWS
// screen reader (see PR #262)
(function(d) {
  let res = {};
  d.querySelectorAll('.remark-help-content table tr').forEach(tr => {
    const t = tr.querySelector('td:nth-child(2)').innerText;
    tr.querySelectorAll('td:first-child .key').forEach(key => {
      const k = key.innerText;
      if (/^[a-z]$/.test(k)) res[k] = t;  // must be a single letter (key)
    });
  });
  d.body.setAttribute('data-at-shortcutkeys', JSON.stringify(res));
})(document);
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
